- name: Install and configure Nginx, Git, Java, and Node.js on web servers
  hosts: webservers
  become: yes

  tasks:
    - name: Install Java (required for Jenkins agent)
      yum:
        name: java-17-amazon-corretto
        state: present

    - name: Install Node.js repository
      shell: curl -fsSL https://rpm.nodesource.com/setup_18.x | bash -
      args:
        creates: /etc/yum.repos.d/nodesource.repo

    - name: Install Node.js and npm
      yum:
        name: nodejs
        state: present

    - name: Install nginx
      yum:
        name: nginx
        state: present

    - name: Install git
      yum:
        name: git
        state: present

    - name: Start and enable nginx
      service:
        name: nginx
        state: started
        enabled: yes